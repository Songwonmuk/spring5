<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
<meta charset="UTF-8">
<title>spring5</title>
</head>
<body>
	<h1>[ spring5 ]</h1>
	
	<p>Thymeleaf의 Security 관련 속성</p>
	
	<!--어떤 권한이건 상관없이 로그인 했다면 -->
	<div sec:authorize="isAuthenticated()">
 		<!--ROLE_USER 권한을 가지고 있다면 -->
        <p sec:authorize="hasRole('USER')">일반 사용자입니다.</p>
        
        <!--ROLE_ADMIN 권한을 갖는다면 -->
        <p sec:authorize="hasRole('ADMIN')">관리자입니다.</p> 

        <!--로그인한 아이디 (username) -->
        <p sec:authentication="name"></p>
        <!--인증시 사용된 객체에 대한 정보-->
        <p sec:authentication="principal"><p>
        <!--권한-->
        <p sec:authentication="principal.authorities"></p>
        
        <!--인증시 사용된 객체에 대한 정보-->
        <p th:text="${#authentication}"></p>
        <p th:text="${#authentication.name}"></p>
        <p th:text="${#authentication.principal}"></p>
        <p th:text="${#authentication.principal.enabled}"></p>
        <p th:text="${#authentication.principal.authorities}"></p>
        
        <!-- 로그인 아이디 확인 -->
        <p th:if="${#authentication.name == 'aaa'}">ID는 aaa입니다. if사용</p>
        <p th:if="${#authentication.name == id}">ID는 aaa입니다. if사용</p>
        <p th:if="${#authentication.name} == ${id}">ID는 aaa입니다. if사용</p>
	</div>

	<!-- 로그인하지 않은 경우 -->
	<div sec:authorize="not isAuthenticated()">
		<p>로그인하지 않음</p>
	</div>

</body>
</html>